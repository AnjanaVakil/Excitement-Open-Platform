package eu.excitement.entailment.core.component.knowledge.parsetree;

import java.io.Serializable;


/**
 * <P> DELETEME_LATER [This code has been imported from BIUTEE, with minor modifications: 1) the field "CanonicalPosTag" is a different type. 2) The exception "UnsupportedPosTagString" is a different type.] </P> 
 * 
 * Represents part-of-speech tag.
 * The purpose of this class is to wrap the part-of-speech tag that is given by an external
 * resource (e.g. parser or pos-tagger).
 * <P><B>THIS CLASS IS IMMUTABLE. SUBCLASSES SHOULD BE IMMUTABLE AS WELL!</B><P>
 * This class is abstract, and each sub-class should specify which tags are supported, and
 * how each tag is mapped to a canonical part-of-speech tag: {@link CanonicalPosTag}.
 * For those purposes, each subclass should override the methods {@link #validatePosTagString(String)}
 * and {@link #setCanonicalPosTag()}.
 * <P>
 * <B>Improtant note for all implementations</B>:
 * The validation, from the user's point of view is optional. I.e. the user may write a code like:
 * <code>
 * <pre>
 * MyPartOfSpeech pos = null;
 * try
 * {
 *    MyPartOfSpeech pos = new MyPartOfSpeech("blabla");
 * }
 * catch(UnsupportedPosTagStringException e)
 * {
 *    // do nothing
 * }
 * ...
 * // continue code here, using pos, and assuming pos is not null.
 * </pre>
 * </code>
 * 
 * @author Asher Stern
 */

public abstract class PartOfSpeech implements Serializable {

	private static final long serialVersionUID = -1476141823590371836L;

	/**
	 * Gets a string that represents the part of speech, and constructs a {@link PartOfSpeech}
	 * object based on that string.
	 * <P>
	 * The flow is as follows:
	 * <ul>
	 * <li>The given string is validated. I.e. the given string is tested whether it is one of the
	 * expected strings for the specific {@link PartOfSpeech} subclass.<li>
	 * <li>Then, it is set as the string representation of this {@link PartOfSpeech} object.
	 * It can be later retrieved by the method {@link #getStringRepresentation()}<li>
	 * <li>Then, a canonical-part-of-speech, i.e. one of the predefined part-of-speech
	 * values in {@link CanonicalPosTag} is chosen, based on the given string. That canonical
	 * value can be retrieved later by the method {@link #getCanonicalPosTag()}<li>
	 * </ul>
	 * @param posTagString
	 * @throws UnsupportedPosTagStringException
	 */
	public PartOfSpeech(String posTagString) throws UnsupportedPosTagStringException
	{
		UnsupportedPosTagStringException exception = null;
		try
		{
			validatePosTagString(posTagString);
		}
		catch(UnsupportedPosTagStringException e)
		{
			exception = e;
		}
		
		if (null==posTagString)
			posTagString="";
		this.posTagString = posTagString;
		this.canonicalPosTag = null;
		setCanonicalPosTag();
		if (null==this.canonicalPosTag)
		{
			this.canonicalPosTag = CanonicalPosTag.OTHER;
		}
		
		if (exception !=null)
			throw exception;
	}

	
	/////////////////////////////// PROTECTED AND PRIVATE //////////////////////////////////////
	
	/**
	 * Assuming the field {@link #posTagString} is already set, this function chooses
	 * one of the appropriate values of {@link CanonicalPosTag} enumeration, and <B>sets
	 * the field</B> {@link #canonicalPosTag}.
	 * @throws UnsupportedPosTagStringException if the given string is not supported
	 */
	protected abstract void setCanonicalPosTag();
	
	/**
	 * Validates that the given string is one of the expected strings for that
	 * sub-class of {@link PartOfSpeech}.
	 * @param posTagString a string that represents part-of-speech. Usually, that string
	 * is given by an external resource, e.g. pos-tagger.
	 * @throws UnsupportedPosTagStringException if the string is not supported.
	 */
	protected abstract void validatePosTagString(String posTagString) throws UnsupportedPosTagStringException;
	
	/**
	 * Suppresses the ability to define an empty constructor.
	 */
	@SuppressWarnings("unused")
	private PartOfSpeech(){}
	
	protected String posTagString;
	protected CanonicalPosTag canonicalPosTag;
	
	private transient boolean hashCodeSet = false;
	private transient int hashCodeValue = 0;
}
